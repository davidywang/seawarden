faeces_l <- read.csv(paste0(filepath, 'faeces_production_Lipids.csv'), header=TRUE, sep=",")
faeces_p <- read.csv(paste0(filepath, 'faeces_production_Proteins.csv'), header=TRUE, sep=",")
feed_c <- read.csv(paste0(filepath, 'wasted_feed_Carbohydrates.csv'), header=TRUE, sep=",")
feed_l <- read.csv(paste0(filepath, 'wasted_feed_Lipids.csv'), header=TRUE, sep=",")
feed_p <- read.csv(paste0(filepath, 'wasted_feed_Proteins.csv'), header=TRUE, sep=",")
nh4 <- read.csv(paste0(filepath, 'NH4_release.csv'), header=TRUE, sep=",")
weight <- read.csv(paste0(filepath, 'weight.csv'), header=TRUE, sep=",")
#extract columns
faeces_c <- faeces_c %>% select(X, V1, V2)
faeces_l <- faeces_l %>% select(V1, V2)
faeces_p <- faeces_p %>% select(V1, V2)
feed_c <- feed_c %>% select(V1, V2)
feed_l <- feed_l %>% select(V1, V2)
feed_p <- feed_p %>% select(V1, V2)
nh4 <- nh4 %>% select(V1, V2)
weight <- weight %>% select(V1, V2) %>% slice(1:nrow(faeces_c))
#compile columns to new dataframe
compiled <- cbind(faeces_c, faeces_l, faeces_p, feed_c, feed_l, feed_p, nh4, weight)
#rename columns
colnames(compiled) <- c("day", "faeces_c1", "faeces_c2", "faeces_l1", "faeces_l2", "faeces_p1", "faeces_p2",
"feed_c1", "feed_c2", "feed_l1", "feed_l2", "feed_p1", "feed_p2",
"nh4_1", "nh4_2", "weight_1", "weight_2")
#write csv
name <- paste0(rac_folder, 'output_files/site_', i, '_compiled.csv')
write.table(compiled, file = name, row.names=FALSE, col.names = TRUE, sep=",")}
i
#compiler_all <- function(rac_folder, site_folder, i)
#load csv files
harvest_path <- paste0(rac_folder, 'site_', i, site_folder)
harvest <-  read.csv(paste0(filepath, 'Days_to_commercial_size.csv'))
compiled_path <- paste0(rac_folder, 'output_files/site_', i, '_compiled.csv')
compiled <- read.csv(compiled_path, header=TRUE, sep=",")
library(dplyr)
#function to combine RAC predictions from one farm site in to one csv file
compiler <- function(rac_folder, site_folder, i){
filepath <- paste0(rac_folder, 'site_', i, site_folder)
#load csv files
faeces_c <- read.csv(paste0(filepath, 'faeces_production_Carbohydrates.csv'), header=TRUE, sep=",")
faeces_l <- read.csv(paste0(filepath, 'faeces_production_Lipids.csv'), header=TRUE, sep=",")
faeces_p <- read.csv(paste0(filepath, 'faeces_production_Proteins.csv'), header=TRUE, sep=",")
feed_c <- read.csv(paste0(filepath, 'wasted_feed_Carbohydrates.csv'), header=TRUE, sep=",")
feed_l <- read.csv(paste0(filepath, 'wasted_feed_Lipids.csv'), header=TRUE, sep=",")
feed_p <- read.csv(paste0(filepath, 'wasted_feed_Proteins.csv'), header=TRUE, sep=",")
nh4 <- read.csv(paste0(filepath, 'NH4_release.csv'), header=TRUE, sep=",")
weight <- read.csv(paste0(filepath, 'weight.csv'), header=TRUE, sep=",")
#extract columns
faeces_c <- faeces_c %>% select(X, V1, V2)
faeces_l <- faeces_l %>% select(V1, V2)
faeces_p <- faeces_p %>% select(V1, V2)
feed_c <- feed_c %>% select(V1, V2)
feed_l <- feed_l %>% select(V1, V2)
feed_p <- feed_p %>% select(V1, V2)
nh4 <- nh4 %>% select(V1, V2)
weight <- weight %>% select(V1, V2) %>% slice(1:nrow(faeces_c))
#compile columns to new dataframe
compiled <- cbind(faeces_c, faeces_l, faeces_p, feed_c, feed_l, feed_p, nh4, weight)
#rename columns
colnames(compiled) <- c("day", "faeces_c1", "faeces_c2", "faeces_l1", "faeces_l2", "faeces_p1", "faeces_p2",
"feed_c1", "feed_c2", "feed_l1", "feed_l2", "feed_p1", "feed_p2",
"nh4_1", "nh4_2", "weight_1", "weight_2")
#write csv
name <- paste0(rac_folder, 'output_files/site_', i, '_compiled.csv')
write.table(compiled, file = name, row.names=FALSE, col.names = TRUE, sep=",")}
rac_folder <- '/Users/Zack/0_rac/rac_seabass/'
site_folder <- '/Bass_population/Outputs/Out_csv/'
#compiler_all <- function(rac_folder, site_folder, i)
#load csv files
harvest_path <- paste0(rac_folder, 'site_', i, site_folder)
harvest <-  read.csv(paste0(filepath, 'Days_to_commercial_size.csv'))
compiled_path <- paste0(rac_folder, 'output_files/site_', i, '_compiled.csv')
compiled <- read.csv(compiled_path, header=TRUE, sep=",")
#extract columns
harvest <- harvest %>% select(3)
harvest <- harvest[[1]]
#sum rows by days of harvest
compiled <- compiled[1:harvest,] %>% select(2, 4, 6, 8, 10, 12)
compiled <- round(colSums(compiled))
compiled <- as.vector(c(i, summary))
filepath
paste0(rac_folder, 'site_', i, site_folder)
rac_folder <- '/Users/Zack/0_rac/rac_seabass/'
site_folder <- '/Bass_population/Outputs/Out_csv/'
#compiler_all <- function(rac_folder, site_folder, i)
#load csv files
harvest_path <- paste0(rac_folder, 'site_', i, site_folder)
harvest <-  read.csv(paste0(rac_folder, 'site_', i, site_folder, 'Days_to_commercial_size.csv'))
compiled_path <- paste0(rac_folder, 'output_files/site_', i, '_compiled.csv')
compiled <- read.csv(compiled_path, header=TRUE, sep=",")
#extract columns
harvest <- harvest %>% select(3)
harvest <- harvest[[1]]
#sum rows by days of harvest
compiled <- compiled[1:harvest,] %>% select(2, 4, 6, 8, 10, 12)
compiled <- round(colSums(compiled))
compiled <- as.vector(c(i, summary))
rac_folder <- '/Users/Zack/0_rac/rac_seabass/'
site_folder <- '/Bass_population/Outputs/Out_csv/'
compiler_all <- function(rac_folder, site_folder, i){
#load csv files
harvest_path <- paste0(rac_folder, 'site_', i, site_folder)
harvest <-  read.csv(paste0(rac_folder, 'site_', i, site_folder, 'Days_to_commercial_size.csv'))
compiled_path <- paste0(rac_folder, 'output_files/site_', i, '_compiled.csv')
compiled <- read.csv(compiled_path, header=TRUE, sep=",")
#extract columns
harvest <- harvest %>% select(3)
harvest <- harvest[[1]]
#sum rows by days of harvest
compiled <- compiled[1:harvest,] %>% select(2, 4, 6, 8, 10, 12)
compiled <- round(colSums(compiled))
compiled <- as.vector(c(i, summary))}
combined = list()
for (i in sites){
combined[[i]]<-compiler_all(rac_folder, site_folder, i)}
sites
combined
compiled
as.vector(c(i, summary, harvest))
harvest_path <- paste0(rac_folder, 'site_', i, site_folder)
harvest <-  read.csv(paste0(rac_folder, 'site_', i, site_folder, 'Days_to_commercial_size.csv'))
compiled_path <- paste0(rac_folder, 'output_files/site_', i, '_compiled.csv')
compiled <- read.csv(compiled_path, header=TRUE, sep=",")
#extract columns
harvest <- harvest %>% select(3)
harvest <- harvest[[1]]
#sum rows by days of harvest
compiled <- compiled[1:harvest,] %>% select(2, 4, 6, 8, 10, 12)
compiled <- round(colSums(compiled))
compiled <- as.vector(c(i, summary, harvest))
compiled
compiled[1:harvest,] %>% select(2, 4, 6, 8, 10, 12)
#load csv files
harvest_path <- paste0(rac_folder, 'site_', i, site_folder)
harvest <-  read.csv(paste0(rac_folder, 'site_', i, site_folder, 'Days_to_commercial_size.csv'))
compiled_path <- paste0(rac_folder, 'output_files/site_', i, '_compiled.csv')
compiled <- read.csv(compiled_path, header=TRUE, sep=",")
#extract columns
harvest <- harvest %>% select(3)
harvest <- harvest[[1]]
#sum rows by days of harvest
compiled <- compiled[1:harvest,] %>% select(2, 4, 6, 8, 10, 12)
compiled
compiled <- compiled[1:harvest,] %>% select(2, 4, 6, 8, 10, 12)
compiled_path <- paste0(rac_folder, 'output_files/site_', i, '_compiled.csv')
compiled <- read.csv(compiled_path, header=TRUE, sep=",")
#extract columns
harvest <- harvest %>% select(3)
harvest_path <- paste0(rac_folder, 'site_', i, site_folder)
harvest <-  read.csv(paste0(rac_folder, 'site_', i, site_folder, 'Days_to_commercial_size.csv'))
compiled_path <- paste0(rac_folder, 'output_files/site_', i, '_compiled.csv')
compiled <- read.csv(compiled_path, header=TRUE, sep=",")
#extract columns
harvest <- harvest %>% select(3)
harvest <- harvest[[1]]
#sum rows by days of harvest
compiled <- compiled[1:harvest,] %>% select(2, 4, 6, 8, 10, 12)
compiled <- round(colSums(compiled))
compiled
as.vector(c(i, summary, harvest))
compiler_all <- function(rac_folder, site_folder, i){
#load csv files
harvest_path <- paste0(rac_folder, 'site_', i, site_folder)
harvest <-  read.csv(paste0(rac_folder, 'site_', i, site_folder, 'Days_to_commercial_size.csv'))
compiled_path <- paste0(rac_folder, 'output_files/site_', i, '_compiled.csv')
compiled <- read.csv(compiled_path, header=TRUE, sep=",")
#extract columns
harvest <- harvest %>% select(3)
harvest <- harvest[[1]]
#sum rows by days of harvest
compiled <- compiled[1:harvest,] %>% select(2, 4, 6, 8, 10, 12)
compiled <- round(colSums(compiled))
compiled <- as.vector(c(i, summary, harvest))}
combined = list()
for (i in sites[2:200]){
combined[[i]] <- compiler_all(rac_folder, site_folder, i)}
#create dataframe
combined_df<-data.frame(do.call(rbind, combined))
colnames(combined_df) <- c("site_ID", "faeces_c", "faeces_l", "faeces_p", "feed_c", "feed_l", "feed_p", "harvest day")
combined_df
compiler_all <- function(rac_folder, site_folder, i){
#load csv files
harvest_path <- paste0(rac_folder, 'site_', i, site_folder)
harvest <-  read.csv(paste0(rac_folder, 'site_', i, site_folder, 'Days_to_commercial_size.csv'))
compiled_path <- paste0(rac_folder, 'output_files/site_', i, '_compiled.csv')
compiled <- read.csv(compiled_path, header=TRUE, sep=",")
#extract columns
harvest <- harvest %>% select(3)
harvest <- harvest[[1]]
#sum rows by days of harvest
compiled <- compiled[1:harvest,] %>% select(2, 4, 6, 8, 10, 12)
compiled <- round(colSums(compiled))
compiled <- as.vector(c(i, compiled, harvest))}
combined = list()
for (i in sites[2:200]){
combined[[i]] <- compiler_all(rac_folder, site_folder, i)}
#create dataframe
combined_df<-data.frame(do.call(rbind, combined))
colnames(combined_df) <- c("site_ID", "faeces_c", "faeces_l", "faeces_p", "feed_c", "feed_l", "feed_p", "harvest day")
combined_df
compiler_all <- function(rac_folder, site_folder, i){
#load csv files
harvest_path <- paste0(rac_folder, 'site_', i, site_folder)
harvest <-  read.csv(paste0(rac_folder, 'site_', i, site_folder, 'Days_to_commercial_size.csv'))
compiled_path <- paste0(rac_folder, 'output_files/site_', i, '_compiled.csv')
compiled <- read.csv(compiled_path, header=TRUE, sep=",")
#extract columns
harvest <- harvest %>% select(3)
harvest <- harvest[[1]]
#sum rows by days of harvest
compiled <- compiled[1:harvest,] %>% select(2, 4, 6, 8, 10, 12)
compiled <- round(colSums(compiled))
compiled <- as.vector(c(i, compiled, harvest))}
combined = list()
for (i in sites){
combined[[i]] <- compiler_all(rac_folder, site_folder, i)}
compiler_all <- function(rac_folder, site_folder, i){
#load csv files
harvest_path <- paste0(rac_folder, 'site_', i, site_folder)
harvest <-  read.csv(paste0(rac_folder, 'site_', i, site_folder, 'Days_to_commercial_size.csv'))
compiled_path <- paste0(rac_folder, 'output_files/site_', i, '_compiled.csv')
compiled <- read.csv(compiled_path, header=TRUE, sep=",")
#extract columns
harvest <- harvest %>% select(3)
harvest <- harvest[[1]]
#sum rows by days of harvest
compiled <- compiled[1:harvest,] %>% select(2, 4, 6, 8, 10, 12)
compiled <- round(colSums(compiled))
compiled <- as.vector(c(i, compiled, harvest))}
combined = list()
for (i in sites[2:length(sites)]){
combined[[i]] <- compiler_all(rac_folder, site_folder, i)}
#create dataframe
combined_df<-data.frame(do.call(rbind, combined))
colnames(combined_df) <- c("site_ID", "faeces_c", "faeces_l", "faeces_p", "feed_c", "feed_l", "feed_p", "harvest day")
combined_df
list.files(paste0(rac_folder, 'output_files/'), pattern = '.csv')
paste0(rac_folder, 'output_files/', i)
sites <- list.files(paste0(rac_folder, 'output_files/'), pattern = '.csv')
compiler_all <- function(rac_folder, site_folder, i){
#load csv files
harvest <-  read.csv(paste0(rac_folder, 'site_', i, site_folder, 'Days_to_commercial_size.csv'))
compiled <- read.csv(paste0(rac_folder, 'output_files/', i), header=TRUE, sep=",")
#extract columns
harvest <- harvest %>% select(3)
harvest <- harvest[[1]]
#sum rows by days of harvest
compiled <- compiled[1:harvest,] %>% select(2, 4, 6, 8, 10, 12)
compiled <- round(colSums(compiled))
compiled <- as.vector(c(i, compiled, harvest))}
combined = list()
for (i in sites){
combined[[i]] <- compiler_all(rac_folder, site_folder, i)}
sites
paste0(rac_folder, 'site_', i, site_folder, 'Days_to_commercial_size.csv')
rac_folder
paste0(rac_folder, 'site_', i, site_folder, 'Days_to_commercial_size.csv')
paste0(rac_folder, i, site_folder, 'Days_to_commercial_size.csv')
i strsplit(i, "_")
strsplit(i, "_")
sites <- list.files(paste0(rac_folder, 'output_files/'), pattern = '.csv')
compiler_all <- function(rac_folder, site_folder, i){
#load csv files
harvest <-  read.csv(paste0(rac_folder, 'site_', strsplit(i, "_"), site_folder, 'Days_to_commercial_size.csv'))
compiled <- read.csv(paste0(rac_folder, 'output_files/', i), header=TRUE, sep=",")
#extract columns
harvest <- harvest %>% select(3)
harvest <- harvest[[1]]
#sum rows by days of harvest
compiled <- compiled[1:harvest,] %>% select(2, 4, 6, 8, 10, 12)
compiled <- round(colSums(compiled))
compiled <- as.vector(c(i, compiled, harvest))}
combined = list()
for (i in sites){
combined[[i]] <- compiler_all(rac_folder, site_folder, i)}
paste0(rac_folder, 'site_', strsplit(i, "_"), site_folder, 'Days_to_commercial_size.csv')
strsplit(i, "_")[2]
(strsplit(i, "_"))[2]
(strsplit(i, "_"))[1]
(strsplit(i, "_"))[1,2]
(strsplit(i, "_"))[[1]]
unlist(strsplit(i, "_"))[1]
sites <- list.files(paste0(rac_folder, 'output_files/'), pattern = '.csv')
compiler_all <- function(rac_folder, site_folder, i){
#load csv files
harvest <-  read.csv(paste0(rac_folder, 'site_', unlist(strsplit(i, "_"))[2], site_folder, 'Days_to_commercial_size.csv'))
compiled <- read.csv(paste0(rac_folder, 'output_files/', i), header=TRUE, sep=",")
#extract columns
harvest <- harvest %>% select(3)
harvest <- harvest[[1]]
#sum rows by days of harvest
compiled <- compiled[1:harvest,] %>% select(2, 4, 6, 8, 10, 12)
compiled <- round(colSums(compiled))
compiled <- as.vector(c(i, compiled, harvest))}
combined = list()
for (i in sites){
combined[[i]] <- compiler_all(rac_folder, site_folder, i)}
#create dataframe
combined_df<-data.frame(do.call(rbind, combined))
colnames(combined_df) <- c("site_ID", "faeces_c", "faeces_l", "faeces_p", "feed_c", "feed_l", "feed_p", "harvest day")
#export dataframe as csv
write.table(combined_df, file = paste0(rac_folder, 'combined.csv'), row.names=FALSE, col.names = TRUE, sep=",")
combined_df
sites <- list.files(paste0(rac_folder, 'output_files/'), pattern = '.csv')
compiler_all <- function(rac_folder, site_folder, i){
#load csv files
id <- unlist(strsplit(i, "_"))[2]
harvest <-  read.csv(paste0(rac_folder, 'site_', id, site_folder, 'Days_to_commercial_size.csv'))
compiled <- read.csv(paste0(rac_folder, 'output_files/', i), header=TRUE, sep=",")
#extract columns
harvest <- harvest %>% select(3)
harvest <- harvest[[1]]
#sum rows by days of harvest
compiled <- compiled[1:harvest,] %>% select(2, 4, 6, 8, 10, 12)
compiled <- round(colSums(compiled))
compiled <- as.vector(c(id, compiled, harvest))}
combined = list()
for (i in sites){
combined[[i]] <- compiler_all(rac_folder, site_folder, i)}
#create dataframe
combined_df<-data.frame(do.call(rbind, combined))
colnames(combined_df) <- c("site_ID", "faeces_c", "faeces_l", "faeces_p", "feed_c", "feed_l", "feed_p", "harvest day")
#export dataframe as csv
write.table(combined_df, file = paste0(rac_folder, 'combined.csv'), row.names=FALSE, col.names = TRUE, sep=",")
combined_df
library(dplyr)
#function to combine RAC predictions from one farm site in to one csv file
compiler <- function(rac_folder, site_folder, i){
filepath <- paste0(rac_folder, 'site_', i, site_folder)
#load csv files
faeces_c <- read.csv(paste0(filepath, 'faeces_production_Carbohydrates.csv'), header=TRUE, sep=",")
faeces_l <- read.csv(paste0(filepath, 'faeces_production_Lipids.csv'), header=TRUE, sep=",")
faeces_p <- read.csv(paste0(filepath, 'faeces_production_Proteins.csv'), header=TRUE, sep=",")
feed_c <- read.csv(paste0(filepath, 'wasted_feed_Carbohydrates.csv'), header=TRUE, sep=",")
feed_l <- read.csv(paste0(filepath, 'wasted_feed_Lipids.csv'), header=TRUE, sep=",")
feed_p <- read.csv(paste0(filepath, 'wasted_feed_Proteins.csv'), header=TRUE, sep=",")
nh4 <- read.csv(paste0(filepath, 'NH4_release.csv'), header=TRUE, sep=",")
weight <- read.csv(paste0(filepath, 'weight.csv'), header=TRUE, sep=",")
#extract columns
faeces_c <- faeces_c %>% select(X, V1, V2)
faeces_l <- faeces_l %>% select(V1, V2)
faeces_p <- faeces_p %>% select(V1, V2)
feed_c <- feed_c %>% select(V1, V2)
feed_l <- feed_l %>% select(V1, V2)
feed_p <- feed_p %>% select(V1, V2)
nh4 <- nh4 %>% select(V1, V2)
weight <- weight %>% select(V1, V2) %>% slice(1:nrow(faeces_c))
#compile columns to new dataframe
compiled <- cbind(faeces_c, faeces_l, faeces_p, feed_c, feed_l, feed_p, nh4, weight)
#rename columns
colnames(compiled) <- c("day", "faeces_c1", "faeces_c2", "faeces_l1", "faeces_l2", "faeces_p1", "faeces_p2",
"feed_c1", "feed_c2", "feed_l1", "feed_l2", "feed_p1", "feed_p2",
"nh4_1", "nh4_2", "weight_1", "weight_2")
#write csv
name <- paste0(rac_folder, 'output_files/site_', i, '_compiled.csv')
write.table(compiled, file = name, row.names=FALSE, col.names = TRUE, sep=",")}
#create one csv per farm site
farmsites <- read.csv('/Users/Zack/0_seawarden/r_rac/master_inventory - Farm_Sites.csv', header=TRUE, sep=",")
sites <- as.vector(farmsites$farm_site)
rac_folder <- '/Users/Zack/0_rac/rac_seabass/'
site_folder <- '/Bass_population/Outputs/Out_csv/'
# rac_folder <- '/Users/Zack/0_rac/rac_bream/'
# site_folder <- '/Bream_population/Outputs/Out_csv/'
for (i in sites){
compiler(rac_folder, site_folder, i)}
#function to combine farm site csv files to single csv
compiler_all <- function(rac_folder, site_folder, i){
#load csv files
id <- unlist(strsplit(i, "_"))[2]
harvest <-  read.csv(paste0(rac_folder, 'site_', id, site_folder, 'Days_to_commercial_size.csv'))
compiled <- read.csv(paste0(rac_folder, 'output_files/', i), header=TRUE, sep=",")
#extract columns
harvest <- harvest %>% select(3)
harvest <- harvest[[1]]
#sum rows by days of harvest
compiled <- compiled[1:harvest,] %>% select(2, 4, 6, 8, 10, 12)
compiled <- round(colSums(compiled))
compiled <- as.vector(c(id, compiled, harvest))}
#combine all
sites <- list.files(paste0(rac_folder, 'output_files/'), pattern = '.csv')
combined = list()
for (i in sites){
combined[[i]] <- compiler_all(rac_folder, site_folder, i)}
#create dataframe
combined_df<-data.frame(do.call(rbind, combined))
colnames(combined_df) <- c("site_ID", "faeces_c", "faeces_l", "faeces_p", "feed_c", "feed_l", "feed_p", "harvest day")
#export dataframe as csv
write.table(combined_df, file = paste0(rac_folder, 'combined.csv'), row.names=FALSE, col.names = TRUE, sep=",")
library(dplyr)
#create one csv per farm site
farmsites <- read.csv('/Users/Zack/0_seawarden/r_rac/master_inventory - Farm_Sites.csv', header=TRUE, sep=",")
sites <- as.vector(farmsites$farm_site)
rac_folder <- '/Users/Zack/0_rac/rac_seabass/'
site_folder <- '/Bass_population/Outputs/Out_csv/'
# rac_folder <- '/Users/Zack/0_rac/rac_bream/'
# site_folder <- '/Bream_population/Outputs/Out_csv/'
#function to combine RAC predictions from one farm site in to one csv file
compiler <- function(rac_folder, site_folder, i){
filepath <- paste0(rac_folder, 'site_', i, site_folder)
#load csv files
faeces_c <- read.csv(paste0(filepath, 'faeces_production_Carbohydrates.csv'), header=TRUE, sep=",")
faeces_l <- read.csv(paste0(filepath, 'faeces_production_Lipids.csv'), header=TRUE, sep=",")
faeces_p <- read.csv(paste0(filepath, 'faeces_production_Proteins.csv'), header=TRUE, sep=",")
feed_c <- read.csv(paste0(filepath, 'wasted_feed_Carbohydrates.csv'), header=TRUE, sep=",")
feed_l <- read.csv(paste0(filepath, 'wasted_feed_Lipids.csv'), header=TRUE, sep=",")
feed_p <- read.csv(paste0(filepath, 'wasted_feed_Proteins.csv'), header=TRUE, sep=",")
nh4 <- read.csv(paste0(filepath, 'NH4_release.csv'), header=TRUE, sep=",")
weight <- read.csv(paste0(filepath, 'weight.csv'), header=TRUE, sep=",")
#extract columns
faeces_c <- faeces_c %>% select(X, V1, V2)
faeces_l <- faeces_l %>% select(V1, V2)
faeces_p <- faeces_p %>% select(V1, V2)
feed_c <- feed_c %>% select(V1, V2)
feed_l <- feed_l %>% select(V1, V2)
feed_p <- feed_p %>% select(V1, V2)
nh4 <- nh4 %>% select(V1, V2)
weight <- weight %>% select(V1, V2) %>% slice(1:nrow(faeces_c))
#compile columns to new dataframe
compiled <- cbind(faeces_c, faeces_l, faeces_p, feed_c, feed_l, feed_p, nh4, weight)
#rename columns
colnames(compiled) <- c("day", "faeces_c1", "faeces_c2", "faeces_l1", "faeces_l2", "faeces_p1", "faeces_p2",
"feed_c1", "feed_c2", "feed_l1", "feed_l2", "feed_p1", "feed_p2",
"nh4_1", "nh4_2", "weight_1", "weight_2")
#write csv
name <- paste0(rac_folder, 'output_files/site_', i, '_compiled.csv')
write.table(compiled, file = name, row.names=FALSE, col.names = TRUE, sep=",")}
for (i in sites){
compiler(rac_folder, site_folder, i)}
#function to combine farm site csv files to single csv
compiler_all <- function(rac_folder, site_folder, i){
#load csv files
id <- unlist(strsplit(i, "_"))[2]
harvest <-  read.csv(paste0(rac_folder, 'site_', id, site_folder, 'Days_to_commercial_size.csv'))
compiled <- read.csv(paste0(rac_folder, 'output_files/', i), header=TRUE, sep=",")
#extract columns
harvest <- harvest %>% select(3)
harvest <- harvest[[1]]
#sum rows by days of harvest
compiled <- compiled[1:harvest,] %>% select(2, 4, 6, 8, 10, 12)
compiled <- round(colSums(compiled))
compiled <- as.vector(c(id, compiled, harvest))}
#combine all
sites <- list.files(paste0(rac_folder, 'output_files/'), pattern = '.csv')
combined = list()
for (i in sites){
combined[[i]] <- compiler_all(rac_folder, site_folder, i)}
#create dataframe
combined_df<-data.frame(do.call(rbind, combined))
colnames(combined_df) <- c("site_ID", "faeces_c", "faeces_l", "faeces_p", "feed_c", "feed_l", "feed_p", "harvest day")
#export dataframe as csv
write.table(combined_df, file = paste0(rac_folder, 'combined.csv'), row.names=FALSE, col.names = TRUE, sep=",")
library(dplyr)
#create one csv per farm site
farmsites <- read.csv('/Users/Zack/0_seawarden/r_rac/master_inventory - Farm_Sites.csv', header=TRUE, sep=",")
sites <- as.vector(farmsites$farm_site)
# rac_folder <- '/Users/Zack/0_rac/rac_seabass/'
# site_folder <- '/Bass_population/Outputs/Out_csv/'
rac_folder <- '/Users/Zack/0_rac/rac_bream/'
site_folder <- '/Bream_population/Outputs/Out_csv/'
#function to combine RAC predictions from one farm site in to one csv file
compiler <- function(rac_folder, site_folder, i){
filepath <- paste0(rac_folder, 'site_', i, site_folder)
#load csv files
faeces_c <- read.csv(paste0(filepath, 'faeces_production_Carbohydrates.csv'), header=TRUE, sep=",")
faeces_l <- read.csv(paste0(filepath, 'faeces_production_Lipids.csv'), header=TRUE, sep=",")
faeces_p <- read.csv(paste0(filepath, 'faeces_production_Proteins.csv'), header=TRUE, sep=",")
feed_c <- read.csv(paste0(filepath, 'wasted_feed_Carbohydrates.csv'), header=TRUE, sep=",")
feed_l <- read.csv(paste0(filepath, 'wasted_feed_Lipids.csv'), header=TRUE, sep=",")
feed_p <- read.csv(paste0(filepath, 'wasted_feed_Proteins.csv'), header=TRUE, sep=",")
nh4 <- read.csv(paste0(filepath, 'NH4_release.csv'), header=TRUE, sep=",")
weight <- read.csv(paste0(filepath, 'weight.csv'), header=TRUE, sep=",")
#extract columns
faeces_c <- faeces_c %>% select(X, V1, V2)
faeces_l <- faeces_l %>% select(V1, V2)
faeces_p <- faeces_p %>% select(V1, V2)
feed_c <- feed_c %>% select(V1, V2)
feed_l <- feed_l %>% select(V1, V2)
feed_p <- feed_p %>% select(V1, V2)
nh4 <- nh4 %>% select(V1, V2)
weight <- weight %>% select(V1, V2) %>% slice(1:nrow(faeces_c))
#compile columns to new dataframe
compiled <- cbind(faeces_c, faeces_l, faeces_p, feed_c, feed_l, feed_p, nh4, weight)
#rename columns
colnames(compiled) <- c("day", "faeces_c1", "faeces_c2", "faeces_l1", "faeces_l2", "faeces_p1", "faeces_p2",
"feed_c1", "feed_c2", "feed_l1", "feed_l2", "feed_p1", "feed_p2",
"nh4_1", "nh4_2", "weight_1", "weight_2")
#write csv
name <- paste0(rac_folder, 'output_files/site_', i, '_compiled.csv')
write.table(compiled, file = name, row.names=FALSE, col.names = TRUE, sep=",")}
for (i in sites){
compiler(rac_folder, site_folder, i)}
#function to combine farm site csv files to single csv
compiler_all <- function(rac_folder, site_folder, i){
#load csv files
id <- unlist(strsplit(i, "_"))[2]
harvest <-  read.csv(paste0(rac_folder, 'site_', id, site_folder, 'Days_to_commercial_size.csv'))
compiled <- read.csv(paste0(rac_folder, 'output_files/', i), header=TRUE, sep=",")
#extract columns
harvest <- harvest %>% select(3)
harvest <- harvest[[1]]
#sum rows by days of harvest
compiled <- compiled[1:harvest,] %>% select(2, 4, 6, 8, 10, 12)
compiled <- round(colSums(compiled))
compiled <- as.vector(c(id, compiled, harvest))}
#combine all
sites <- list.files(paste0(rac_folder, 'output_files/'), pattern = '.csv')
combined = list()
for (i in sites){
combined[[i]] <- compiler_all(rac_folder, site_folder, i)}
#create dataframe
combined_df<-data.frame(do.call(rbind, combined))
colnames(combined_df) <- c("site_ID", "faeces_c", "faeces_l", "faeces_p", "feed_c", "feed_l", "feed_p", "harvest day")
#export dataframe as csv
write.table(combined_df, file = paste0(rac_folder, 'combined.csv'), row.names=FALSE, col.names = TRUE, sep=",")
